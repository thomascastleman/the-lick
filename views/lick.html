<!DOCTYPE html>
<html>
<head>
	<title>{{#report.title_exists}}{{report.video_title}} | {{/report.title_exists}}The Lick</title>
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="/navbar.css">
	<link rel="stylesheet" type="text/css" href="/lick.css">
	<script
		src="https://code.jquery.com/jquery-3.4.1.min.js"
		integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
		crossorigin="anonymous"></script>
	<script src="https://www.youtube.com/iframe_api"></script>
	<script>
		{{#isModerator}}
		// request to remove a reporting from the db
		function deleteLick() {
			if (confirm("Are you sure you want to permanently remove this lick report?")) {
				$.post("/deleteReporting", { uid: "{{report.uid}}" }, function(res) {
					if (!res.err) {
						window.location.href = "/";
					} else {
						alert("Failed to remove report from database: " + res.err);
					}
				});
			}
		}
		{{/isModerator}}

		var player;
		function onYouTubeIframeAPIReady() {
			player = new YT.Player('lick', {
				height: '390',
				width: '640',
				videoId: '{{report.video_id}}',
				events: {
					'onReady': onPlayerReady,
				}
			});
		}

		// The API will call this function when the video player is ready.
		function onPlayerReady(event) {
			event.target.playVideo();
		}
    </script>
</head>
<body>
	<div class="navbar">
		<ul>
			<li id="home-link"><strong><a href="/">thelick.com</a></strong></li>
			<div style="float:right">
				<li><a href="/report">Report a Sighting <i class="fas fa-search"></i></a></li>
				{{^isModerator}}<li><a href="/login">Moderator Login <i class="fas fa-sign-in-alt"></i></a></li>{{/isModerator}}
				{{#isModerator}}
				<li><a href="/moderator">Moderator Portal <i class="fas fa-tools"></i></a></li>
				<li><a href="/logout">Log Out <i class="fas fa-sign-out-alt"></i></a></li>
				{{/isModerator}}
			</div>
		</ul>
	</div>
	<div class="container">
		{{#report}} 
		 	{{#title_exists}}<h3><a href="{{url}}">{{video_title}}</a></h3>{{/title_exists}}
			<!-- <iframe width="560" height="315" src="https://youtube.com/embed/{{video_id}}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe> <br> -->
			<div id="lick"></div>
			<p>The lick occurs at <a href="#" onclick="player.seekTo({{lick_start}});">{{lick_start_string}}</a></p>
			<p>{{notes}}</p>
			<p>Reported on {{date_reported}}{{#reporter_exists}} by {{reporter_name}}{{/reporter_exists}}</p>
		{{/report}}
		{{#isModerator}}<button onclick="deleteLick();">Delete Report</button>{{/isModerator}}
	</div>
</body>
</html>